!function(o){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return o[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};t.m=o,t.c=i,t.i=function(o){return o},t.d=function(o,i,n){t.o(o,i)||Object.defineProperty(o,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(o){var i=o&&o.__esModule?function(){return o.default}:function(){return o};return t.d(i,"a",i),i},t.o=function(o,t){return Object.prototype.hasOwnProperty.call(o,t)},t.p="",t(t.s=4)}([function(o,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(o){"object"==typeof window&&(i=window)}o.exports=i},function(o,t){o.exports=XP},function(o,t){o.exports=XPEmitter},function(o,t,i){(function(t){const n="undefined"!=typeof window?window:t,r=n.XP||i(1),e=n.XPEmitter||i(2),s=i(5);o.exports=n.XPHouse=new r.Class("XPHouse",{extends:e,initialize(){e.call(this),this.floors={},this.on("close",this._handleClose.bind(this))},isRoom(o,t){return!!this.floors[t||""]&&!!this.floors[t||""][o]},rooms(o){return r.values(this.floors[o||""]||{})},kick:{callback:!0,value(o,t,i,n){return r.isString(t,!0)?r.isFunction(o)||r.isObject(o)?r.isVoid(i)||r.isString(i)?(i=this.floors[i||""]||{},i[t]?void i[t].kick(o,n):void n(r.error(404,`Room "${t}" not found.`))):void n(r.error(500,'"floor" must be string.')):void n(r.error(500,'"identity" must be Function or Object.')):void n(r.error(500,'"room" must be string.'))}},room:{callback:!0,value(o,t,i){if(r.isVoid(t)&&(t={}),!r.isString(o,!0))return void i(r.error(500,'"name" must be string.'));if(!r.isObject(t))return void i(r.error(500,'"options" must be Object.'));if(!r.isVoid(t.cursor)&&!r.isObject(t.cursor))return void i(r.error(500,'"options.cursor" must be Object.'));if(!r.isVoid(t.floor)&&!r.isString(t.floor))return void i(r.error(500,'"options.floor" must be string.'));let n=this.floors[t.floor||""]=this.floors[t.floor||""]||{},e=n[o]||new s(o,t);n[o]||(e.on("close",()=>this.emit("close",e)),e.on("join",o=>this.emit("join",e,o)),e.on("leave",o=>this.emit("leave",e,o)),n[o]=e),i(null,e)}},floors:{set(o){return this.floors||o},validate(o){return!r.isObject(o)&&"Object"}},_handleClose(o){delete this.floors[o.floor||""][o.name]}})}).call(t,i(0))},function(o,t,i){o.exports=i(3)},function(o,t,i){(function(t){const n="undefined"!=typeof window?window:t,r=n.XP||i(1),e=n.XPEmitter||i(2);o.exports=new r.Class("Room",{extends:e,initialize(o,t){e.call(this),this.closed=!1,this.roomers=[],this.name=o,this.options=t,this.autoClose=this.options.autoClose||!1,this.cursor=this.options.cursor||null,this.floor=this.options.floor||null},close:{callback:!0,value(o){if(this.closed)return void o(null,!1);this.closed=!0,this.roomers.forEach(o=>this.kick(o)),this.cursor&&this.cursor.close(),o(null,!0)}},kick:{callback:!0,value(o,t){if(!r.isFunction(o)&&!r.isObject(o))return void t(r.error(500,'"identity" must be Function or Object.'));let i=this.roomers.findIndex(r.isFunction(o)?o:t=>t===o);if(i<0)return void t(null,!1);this.emit("leave",this.roomers.splice(i,1)[0]),this.autoClose&&this.empty&&this.close(),t(null,!0)}},let:{callback:!0,value(o,t){if(!r.isObject(o))return void t(r.error(500,'"roomer" must be Object.'));if(this.closed)return void t(null,!1);let i=this.roomers.indexOf(o);i<0&&(i=this.roomers.push(o)-1),this.emit("join",this.roomers[i]),t(null,!0)}},autoClose:{set(o){return r.isDefined(this.autoClose)?this.autoClose:!!o}},roomers:{set(o){return this.roomers||o},validate(o){return!r.isArray(o)&&"Array"}},closed:{set(o){return this.closed||!!o},then(o){return o&&this.emit("close")}},cursor:{set(o){return r.isDefined(this.cursor)?this.cursor:o},validate(o){return!r.isNull(o)&&!r.isObject(o)&&"Object"}},empty:{get(){return!this.roomers.length}},floor:{set(o){return r.isDefined(this.floor)?this.floor:o},validate(o){return!r.isNull(o)&&!r.isString(o,!0)&&"string"}},name:{set(o){return this.name||o},validate(o){return!r.isString(o,!0)&&"string"}}})}).call(t,i(0))}]);